2007-01-03  Per Bothner  <per@bothner.com>

	* KawaServlet.java (doGet): Set currentPath to relative to requestURL.
	* ServletCallContext.java (getBaseUri): Remove method.

2007-01-02  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java: Update to use URIPath.
	* ReplSession.java: Update to use Paths.

2006-12-20  Per Bothner  <per@bothner.com>

 	* Makefile.am (KAWA1): Remove unneeded macro.

2006-12-06  Per Bothner  <per@bothner.com>

	* ReplSession.java: Update for renamed Consumer methods.
	* KawaServlet.java: Likewise.

2006-12-04  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java: Update to use ModuleInfo.sourceAbsPath.

2006-11-22  Per Bothner  <per@bothner.com>

	* ReplSession.java: Partially revert changes from 11-17 and 11-18.

2006-11-17  Per Bothner  <per@bothner.com>

	* ReplSession.java: Update writeChar -> append.

2006-11-09  Per Bothner  <per@bothner.com>

	* ReplSession.java: Update for Consumer changes.

2006-08-08  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (LAST_MODIFIED_CACHE_TIME): Moved field
	to ModuleManager.
	(getModule): Use ModuleManager's lastModifiedCacheTime instead.

	* KawaPageServlet.java (getModule): Initialize module state to WALKED.

2006-02-09  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getModule): ModuleExp.evalToClass now does a
	little less, so we must do a little more.

2006-01-10  Per Bothner  <per@bothner.com>

	* HTTP.scm: Moved to gnu/kawa/slib.
	* Makefile.am: Update accordingly. 

2005-12-11  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getModule): Better error catching.
	Update evalToClass call to also pass in URL.

2005-11-16  Per Bothner  <per@bothner.com>

	* ReplSession.java (println): It suffices to just write a newline.
	(appendInput): New method - like appendInputLine without newline.
	* ReplServlet.java (doPost): Handle new action command.

2005-11-08  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getModule): Put ModuleInfo in hashtable.  Ooops.

2005-11-03  Per Bothner  <per@bothner.com>

	* ReplSession.java: Major changes, mainly to support emitting
	html/xml into output.  Don't encode to XML character entities here.
	(class OutBufferWriter): Extend OutPort.
	Interject XMLPrinter between this and PrettyWriter.
	(write methods): Write to PrettyWriter's buffer.
	(beginGroup, endGroup, beginAttribute, endAttribute): New methods
	to allows us to emit element tags without extra encoding.
	(flush, flushhToSessionBuffer): 

2005-10-31  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java: Partial re-write replace the procedureCach
	and instead use gnu.expr.ModuleContext.
	(class CacheEntry): Remove class.
	* KawaPageServlet.java: Use gnu.expr.Language to detect the source
	language, rather than depending on file extension.
	Also, support a default handler module.

2005-10-27  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getModule): Call Language's resolve method.

2005-10-17  Per Bothner  <per@bothner.com>

	* ReplServlet.java: New class, extends HttpServlet.
	* ReplSession.java: New class.

2005-05-18  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getModule): Don't set current Environment
	using current Language.

2005-03-14  Christian Surlykke <christian@surlykke.dk>

	* KawaPageServlet.java:  Missed Interpreter -> Language fix.

2005-03-07  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java: Update Interpreter -> Language.

2005-03-04  Per Bothner  <per@bothner.com>

	* KawaServlet.java: Update Interpreter -> Language.

2004-08-11  Per Bothner  <per@bothner.com>

	* KawaServlet.java (run): New abstract method, replaces ...
	(apply):   Removed abstract method.
	* KawaPageServlet.java (apply):  Rename to run.

2004-08-10  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getProcedure): Rename to getModule and
	change return type to Module.
	(apply):  Call run method of module, not apply method.
	(class CacheEnty):  Change proc field to ModuleBody.
	* KawaServlet.java (run)  Add abstract method, overriden by compiler.
	(doGet):  Call run method, rather than apply method.

2004-08-08  Per Bothner  <per@bothner.com>

	* KawaServlet.java (doGet): Change for new Procedure API.

2004-08-03  Per Bothner  <per@bothner.com>

	* GetRequest.java:  Extend MethodProc instead of CpsProcedure.
	* GetResponse.java:  Likewise.

2003-11-16  Per Bothner  <per@bothner.com>

	* CGIServletWrapper.java (getLocalPort, getLocalName, getRemotePort):
	New methods required by Servlets 2.4.
	(setCharacterEncoding):  Remove throws clause, for 2.4 compatibility.

	* CGIServletWrapper.java (isSecure):  More real implementation.

2003-10-29  Gerardo Jorvilleur <magoghm@Prodigy.net.mx>

	* KawaServlet.java (doPost):   New method.

2003-11-02  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getProcedure):  Replace 'parseFile' call
	by call to new 'parse' method.

2003-06-05  Per Bothner  <per@bothner.com>

	* ServletCallContext.java (getBaseUri):  Use entire request url,
	not just scheme+directory prefix.

2003-05-08  Per Bothner  <per@bothner.com>

	* KawaServlet.java (doGet):  Unwrap WrappedException.

	* KawaPageServlet.java (getProcedure):  Set file name of InPort.

	* KawaPageServlet.java (getProcedure):  Catch SyntaxException.

2003-03-02  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java (getProcedure):  Use getOutputStream instead
	of getWriter.to avoid a possible IllegalStateException.

	* ServletCallContext.java (getBaseUri):  New method.

2003-02-20  Per Bothner  <per@bothner.com>

	* KawaPageServlet.java:  New class.  Contributed by Ivelin Ivanov
	<ivelin@apache.org> and Tom Reilly <treilly@macromedia.com>.
	* KawaServlet.java (doGet):  Catch exceptions.
	(apply(CallContext)):  Add throws specification.
	* Makefile.am (java_sources):  Added KawaPageServlet.java.

2002-07-29  Per Bothner  <per@bothner.com>

	* ServletCallContext.java:  Make class public.
	(getServletCallContext, getRequest, getResponse, getServlet,
	getServletConfig, getServletContext):  New static methods.
	* GetResponse.java:  Implement Inlineable.
	(compile, getReturnType):  New methods.
	(getReponse):  New static method.

	* ServletPrinter.java (addHeader):  Handle "Status", calling sendError.
	* CGIServletWrapper.java (statusCode, statusString):  New fields.
	(sendError, setStatus):  Provide implementations.
	(printHeaders):  Handle non-null statusCode.

2002-03-02  Per Bothner  <per@bothner.com>

	* HTTP.scm:  Moved to gnu/kawa/slib.
	* Makefile.am:  Simplify accordingly.

2002-02-14  Per Bothner  <per@bothner.com>

	* CGIServletWrapper.java:  Implement ServletContext.
	Add necessary methods.
	(getServletContext):  Return this.
	(getRequestURL):  Emit '/' between server-name and request-uri.
	* KawaServlet.java (doGet):  Call CallContext.setInstance if need be.
	* Makefile.am (SCM_COMPILE_FLAGS):  Specify --full-tailcalls.
	* ServletPrinter.java (addHeader):  Maybe set super.sawContentType,
	but don't call super's addHeader.
	(PrintHeaders):  New, empty method.
	(printHeader):  Removed - no longer needed.

2002-02-13  Per Bothner  <per@bothner.com>

	* KawaServlet.java )doGet):  Don't call CallContext.setInstance.

2002-02-05  Per Bothner  <per@bothner.com>

	* CGIServletWrapper.java:  Also implement ServletConfig.
	(getInitParameter, getInitParameterNames, getServletContext,
	getServletName):  New methods, needed to implement ServletConfig.
	(main):  Call init on servlet, passing in the CGIServletWrapper.

2002-01-31  Per Bothner  <per@bothner.com>

	* HTTP.scm (response-header, response-content-type, request-path-info,
	request-path-translated, request-query-string):  New procedures.

	* Makefile.am (EXTRA_DIST):  Add scm files.

2002-01-29  Per Bothner  <per@bothner.com>

	* CGIServletWrapper.java:  New class, to wrap servlets as CGI scripts.
	* HTTP.scm:  New helper functions, to access http parameters.
	* Makefile.am:  Update accordingly.  Thsi incldues adding rules
	for compiling the new HTTP.scm module.

2002-01-19  Per Bothner  <per@bothner.com>

	* KawaServlet.java (doGet):  Use CallContext.setInstance.

2002-01-13  Per Bothner  <per@bothner.com>

	* ServletPrinter.java:  New class, extends HttpPrinter.
	* Makefile.am (java_sources):  Added ServletPrinter.java.
	* KawaServlet.java (doGet):  Use new ServletPrinter.
	Let latter do setContentType, so odn't do it here.
	Likewise. don't emit <html> and </html>.
	On the other hand, do emit beginDocument and endDocument.

2001-11-24  Per Bothner  <per@bothner.com>

	* GetRequest.java:  Now implements Inlineable.

	* KawaServlet.java (apply):  No longer final.  Needs to be overridden
	if servlet contains a function definition.  Make body empty - not used.

2001-11-18  Per Bothner  <per@bothner.com>

	* ServletCallContext.java:  New file, old class moved
	from KawaServlet.java into its own file.

	* GetRequest.java:  New class, extends CpsProcedure.
	* GetResponse.java:  New class, extends CpsProcedure.
	* Makefile.am (java_sources):  Update accordingly.

2001-10-11  Per Bothner  <per@bothner.com>

	New package.
	* KawaServlet.java:  New class.
	* Makefile.am:  New.
