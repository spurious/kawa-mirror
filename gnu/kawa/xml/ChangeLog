2006-06-27  Per Bothner  <per@bothner.com>

	* OutputAsXML.java: Change implementation so it returns an FString
	value.  Alas, we lose some optimization.

2006-06-16  Per Bothner  <per@bothner.com>

	* MakeElement.java: Add support for interpreting keyword parameters
	as attribute constructors.
	(tag): New field.
	* Nodes.java (inAttribute): New field.
	(beginAttribute): Set it.
	(endAttribute): Ignore if inAttribute not set.

2006-03-27  Per Bothner  <per@bothner.com>

	* BinaryObject.java: New abstract class.
	* Base64Binary.java: New class, extends BinaryObject.
	* HexBinary.java: New class, extends BinaryObject.
	* Makefile.am: Update accordingly.
	* XDataType.java (base64BinaryType, hexBinaryType): New static fields.
	(cast, valueOf): Add support for new types.
	(parseHexBinary): Remove method - now in HexBinary.java.

	* XDataType.java (decimalType): Change implementation type to
	java.lang.Number.

2006-03-26  Per Bothner  <per@bothner.com>

	* XTimeType.java (typeXTimeType): Remove field, replacing it by ...
	(typeDateTime): .. new static field.
	(<init>): Use typeXTimeType by typeDateTime.	

	* XMLParser.java: Move "implements" into conditionally-compiled section.

	* StringValue.java: No longer extend Procedure1.
	(stringValue, string): Removed fields.
	(<init>, apply1): Removed methods.
	(stringValue): Merge in multi-item support from removed apply1.

2006-03-20  Per Bothner  <per@bothner.com>

	* NodeName.java (nodeName): Map String to SName, so the result will
	be an instance of xs:QName.

2006-03-17  Per Bothner  <per@bothner.com>

	* AttributeType.java (make(Symbol)): New factory method.
	* ElementType.java (make(Symbol)): New factory method.

	* XMLParser.java: Also implement org.xml.sax.Locator.
	(getName): Remove method.
	(getPublicId, getSystemId): New methods, impleementing Locator.
	(getLineNumber, getColumnNumber): Change to be consistent with SAX.	

2006-03-15  Per Bothner  <per@bothner.com>

	* ProcessingInstructionType.java: New class extends NodeType.
	* Makefile.am: Update accordingly.
	* MakeProcInst.java: New extends NodeConstructor.  Re-write
	accordingly.  Add some XQuery-required error checking.

2006-03-14  Per Bothner  <per@bothner.com>

	* StringValue.java: New class, some parts moved from gnu.xquery.utils.
	* CommentConstructor.java: No longer need to import StringValue.
	* MakeCDATA.java: Likewise.
	* MakeText.java: Likewise.

	* Document.java (parseCached, availableCached): Fixes needed for
	XPath/XQuery semantics.

	* KNode.java (atomicValue): Moved here from  gnu.xquery.util.NodeUtils.
	Kludge to create UntypedAtomic.

	* UntypedAtomic.java: New class.
	* XDataType.java: New class, extends gnu.bytecode.Type.
	* XTimeType.java: New class, extends XDataType.
	* XIntegerType.java: New class, extends XDataType.
	* XInteger.java: New class, extends gnu.math.IntNum.
	* Makefile.am (java_sources): Update accordingly.

2006-03-01  Per Bothner  <per@bothner.com>

	* SortNodes.java (compile): Don't canonicalize result, if target
	is ConsumerTarget or a StackTarget that takes a Values subtype.

2006-02-16  Per Bothner  <per@bothner.com>

	* Nodes.java (item): Fix bad recursion.
	Only include if use:org.w3c.dom.Node PreProcess-flag is given.

2006-02-16  Per Bothner  <per@bothner.com>

	* AttributeType.java: Fix tabs/spacing to PreProcess works properly,
	* ElementType.java: Likewise.

2006-02-05  Per Bothner  <per@bothner.com>

	* WriteTo.java (writeToIfChange): New static method and field.
	(ifChanged): New flag.
	(apply2): Use it.

2006-01-11  Per Bothner  <per@bothner.com>

	* HttpPrinter.java: If we see data (including beginGroup) before a
	beginDocumnet, pretend we saw a beginDocument anyway. This makes
	creating servlet output more flexible and easier, since we don't
	have to wrap everything in beginDocument/endDocument.

2006-01-04  Per Bothner  <per@bothner.com>

	* Document.java: No longer extend Procedure1.
	(appl1, apply): Remove methods.
	(makeURL): Remove methods - using URI_utils.resolve.
	(parse): Use generalized XMLParser constructor.
	(parseCached): Handle generauized names.
	* XMLParser.java (<init>): Handle generalized names.

2005-12-31  Per Bothner  <per@bothner.com>

	* KNode.java: Remove TAB in conditional text.
	* KAttr.java: Likewise.
	* KDocument.java: Likewise.

2005-12-10  Per Bothner  <per@bothner.com>

	* Document.java (makeURL): Update because BaseUri.hasScheme
	was moved and renamed to InPort.uriSchemeSpecified.

2005-11-14  thomas kirk  <tk@research.att.com>

	* HttpPrinter.java (endDocument): cclose OutPort.
	* KNode.java (toString): Close OutPort.

2005-11-03  Per Bothner  <per@bothner.com>

	* KNode.java: Implement Consumable.
	(consume): New method.

	* KNode.java (copy): New method, overrides SeqPosition.

2005-10-06  Per Bothner  <per@bothner.com>

	* CommentConstructor.java (numArgs): New method.

	* KText.java (make(String)): New static method.
	* MakeText.java: Extend NodeConstructor.
	(compileToNode): New method.
	(numArgs, apply1): New methods.
	(text$X, text$C): New static methods.
	(apply): Just call text$X.

2005-08-18  Per Bothner  <per@bothner.com>

	* Document.java (parseCached, availableCached): New static functions.

2005-08-16  Per Bothner  <per@bothner.com>

	* Nodes.java (writePosition) Change return type to void.
	* SortedNodes.java (writePosition): Likewise.

	* NodeConstructor.java (popNodeConsumer): Wrap NodeTree in KNode,
	as in 2004-05-20 change to popNodeContext.

2005-04-17  Per Bothner  <per@bothner.com>

	* KAttr.java: Make org.w3c.dom.*-dependencies conditional on
	new 'use:org.w3c.dom.Node' pre-processor condition.
	The default is now 'off'.
	* KCDATASection.java: Likewise.
	* KCharacterData.java: Likewise.
	* KComment.java: Likewise.
	* KDocument.java: Likewise.
	* KElement.java: Likewise.
	* KNode.java: Likewise.
	* KProcessingInstruction.java: Likewise.
	* KText.java: Likewise.
	* Nodes.java: Likewise.

2005-03-06  Per Bothner  <per@bothner.com>

	* DefineNamespace.java: Moved to gnu.kawa.lispexpr.
	The reason is so namespaces can work even when --disable-xml.

2005-03-03  Per Bothner  <per@bothner.com>

	* Children.java: Moved from gnu.mapping.xquery, because it is also
	used for Scheme.
	* Makefile.am: Update accordingly.

2005-02-12  Per Bothner  <per@bothner.com>

	* DefineNamespace.java: Use different SetExp constructor,
	to avoid setting the 'binding' field, which will become private.

2005-01-22  Per Bothner  <per@bothner.com>

	* NodeType.java: Extend ObjectType, not ClassType.

2005-01-07  Per Bothner  <per@bothner.com>

	* MakeElement.java: Remove unneeded import.
	* NodeName.java: Likewise.

2005-01-02  Per Bothner  <per@bothner.com>

	* Focus.java, IteratorItems.java, ListItems.java:
	Change "select" (preprocessor) syntax.

2004-12-22  Per Bothner  <per@bothner.com>

	* AttributeConstructor.java: Removed - we now use MakeAttribute.
	* ElementConstructor.java: Removed - we now use MakeElement.
	* MakeElement.java: Moved from gnu.xquery.util.
	No longer implement CanInline - which re-wrote to ElementConstructor.
	Merg in namespaceNodes functionality from ElementConstructor.
	(getTagName): New static helper method.
	* MakeAttribute.java: Moved from gnu.xquery.util.
	(makeAttributeExp): New static field.
	(beginAttribute): Simplify.
	* Makefile.am: Update accordingly.

	* KAttr.java: Update to new "conditional configuration" syntax.
	* KDocument.java: Likewise.
	* KElement.java: Likewise.
	* KNode.java: Likewise.
	* AttributeType.java: Handle SName, and QName if using JAXP 1.3.
	* ElementType.java: Likewise.

	* NodeName.java: Simplify now that XName is qn SName/QName.

2004-12-05  Per Bothner  <per@bothner.com>

	* AttributeConstructor.java: Update Symbol->Location.
	* CommentConstructor.java: Likewise.
	* DocumentConstructor.java: Likewise.
	* ElementConstructor.java: Likewise.
	* MakeCDATA.java: Likwise.
	* MakeText.java: Likwise.

	* AttributeType.java (<init>): Removed constructor, replaced by ...
	(make): New static method, called in code generated by XQParser.
	* ElementType.java: Likewise.

	* DefineNamespace.java (scanForDefinitions): Type bound to the
	namespace isn't always a String - it can also be a ClassType.
	* NamespaceEnv.java: Removed.
	* Makefile.am: Update accordingly.

2004-11-06  Per Bothner  <per@bothner.com>

	* ElementConstructor.java (setNamespaceNodes): Use new XName
	constructor.
	* KNnode.java (coerce): New static convenience methods.
	(getNodeValue(StringBuffer)): New helper method.

	* KNode.java: Add some DOM3 (in JAXP 1.3 and Java 5) methods.
	Some are commented out unless --with-java-source=5, since they
	reference types that aren't in DOM 2.
	* KAttr.java: Likewise.
	* KDocument.java: Likewise.
	* KElement.java: Likewise.
	* KText.java: Likewise.

	* NodeCompare.java: Use non-deprecated WrongType.make variants.

2004-08-03  Per Bothner  <per@bothner.com>

	* Attributes.java:  Extend MethodProc instead of CpsProcedure.
	* CommentConstructor.java:  Likewise.
	* IteratorItems.java:  Likewise.
	* ListItems.java:  Likewise.
	* MakeCDATA.java:  Likewise.
	* MakeProcInst.java:  Likewise.
	* MakeResponseHeader.java:  Likewise.
	* MakeText.java:  Likewise.
	* NodeConstructor.java:  Likewise.
	* OutputAsXML.java:  Likewise.
	* TreeScanner.java:  Likewise.

2004-07-20  Per Bothner  <per@bothner.com>

	* AttributeConstructor.java:  Remove unused import statements.
	* CommentConstructor.java:  Likewise.
	* DefineNamespace.java:  Likewise.
	* KAttr.java:  Likewise.
	* KCDATASection.java:  Likewise.
	* KCharacterData.java:  Likewise.
	* KComment.java:  Likewise.
	* KDocument.java:  Likewise.
	* KElement.java:  Likewise.
	* KProcessingInstruction.java:  Likewise.
	* KText.java:  Likewise.
	* MakeCDATA.java:  Likewise.
	* MakeProcInst.java:  Likewise.
	* MakeResponseHeader.java:  Likewise.
	* MakeText.java:  Likewise.
	* MakeUnescapedData.java:  Likewise.
	* SortedNodes.java:  Likewise.
	* WriteTo.java:  Likewise.

2004-06-22  Per Bothner  <per@bothner.com>

	* KAttr.java (getObjectValue):  New method.

2004-05-29  Per Bothner  <per@bothner.com>

	* MakeCDATA.java (apply):  Remove accidental debu message.

2004-05-28  Per Bothner  <per@bothner.com>

	* CDataConstructor.java:  Renamed to ..
	* MakeCDATA.java:  ... new name.
	* TextConstructor.java:  Renamed to ..
	* MakeText.java:  ... new name.
	* MakeProcInst.java:  New class, extends CpsProcedure.
	* Makefile.am:  Update accordingly.

2004-05-20  Per Bothner  <per@bothner.com>

	* CDataConstructor.java:  New class, extends CpsProcedure.
	* KCharacterData.java:  New class, extends KNode.
	* KComment.java:  new class, extends KCharacterData.
	* KText.java:  Change to inherit KCharacterData.
	Move most methods to KCharacterData.
	* KCDATASection.java:  New class, extends KText.
	* KProcessingInstruction.java:  New class, extends KNode.
	* Makefile.am:  Update accordingly.

	* KText.java (getNodeType):  Fix to return TEXT_NODE.

	* KNode.java (make):  Handle CDATA_VALUE, COMMENT_VALUE
	and PROCESSING_INSTRUCTION_VALUE.
	An empty NodeTree is treated as an empty text node.

	* KNode.java (toString):  New method.

	* NodeConstructor.java (popNodeContext):  Wrap NodeTree as KNode.

2004-05-05  Per Bothner  <per@bothner.com>

	* CommentConstructor.java:  New class.
	* Makefile.am:  Update accordingly.
	* NodeConstructor.java (pushNodeContext):  Now returns XConsumer.
	* NodeType.java (PROCESSING_INSTRUCTION_OK):  Renamed to PI_OK.
	* Nodes.java (writeCDATA):  New method.

2004-04-18  Per Bothner  <per@bothner.com>

	* NodeType.java (COMMENT_OK, PROCESSING_INSTRUCTION_OK): New constants.
	(isInstance):  Handle new macros.
	* Nodes.java (writeComment, writeProcessingInstruction):  New methods.

2004-03-09  Per Bothner  <per@bothner.com>

	* NodeName.java (nodeName):  If name is XName, extract its QName.

	* NodeType.java (DOCUMENT_OK):  New constant.
	(isInstance):  If kind is a DOCUMENT_VALUE, check DOCUMENT_OK.

2004-02-15  Per Bothner  <per@bothner.com>

	* DefineNamespace.java (rewrite):  Move handling to scanForDefinitions.

	* DefineNamespace.java (rewriteForm):  Use Translator's exp2Type.

2004-01-04  Per Bothner  <per@bothner.com>

	* Document.java (parse):  Returns a KDocument rather than a NodeTree.

2004-01-03  Per Bothner  <per@bothner.com>

	* KNode.java:  New class, extends SeqPosition, implements Node.
	* KText.java:  New class, extends KNode, implements Text.
	* KAttr.java:  New class, extends KNode, implements Attr.
	* KDocument.java:  New class, extends KNode, implements Document.
	* KElement.java:  New class, extends KNode, implements Element.
	* Makefile.am (java_sources):  Add new files.

	* ElementType.java (coerceOrNull, coerce):  Return a KElement.
	* NodeType.java (typeSeqPosition):  Replace by typeKNode.
	(nodeType):  Is now a KNode rather than a SeqPosition.
	(getImplementationType):  Return typeKNode instead of typeSeqPosition.
	(isInstance):  Instance must now be a KNode.
	(coerceForce, coerceOrNull):  Now check for KNode.
	* NodeConstructor.java (typeKNode):  New static field.
	(compileUsingNodeTree):  At end convert NodeTree to KNode.
	* Nodes.java:  Now implements org.w3c.dom.NodeList.
	(getLength, item):  New methods
	(get):  Use KNode.make to return a KNode rather than a SeqPosition.
	(getPosNext):  New optimized implementation.
	(root(AbstractSequence,int)):  Take a NodeTree and return a KNode.
	(root(Object)):  Require a KNode.
	* TreeScanner.java (apply):  Argument must be a KNode.

2003-12-24  Per Bothner  <per@bothner.com>

	* AttributeConstructor.java (setQName):  New method.
	(make):  Don't bother interning the sname.
	* ElementConstructor.java (qname):  Renamed field to 'type'
	and changed its type to Object.
	(getQName, getNamespaceURI, getLocalName):  Rewrite.
	(setQName, getNamespaceNodes, setNamespaceNodes):  New methods.
	(make, readExternal):  Don't bother interning the sname.

2003-11-02  Per Bothner  <per@bothner.com>

	* XMLParser.java (<init>):  Remove unneeded throws specifications.

2003-10-29  Per Bothner  <per@bothner.com>

	* AttributeType.java (isInstance, coerceOrNull):  Handle XName.
	* ElementType.java (isInstance, coerceOrNull):  Handle XName.

2003-10-16  Per Bothner  <per@bothner.com>

	* Nodes.java (getSeq, getPos):  New convenience functions.
	* IntersectNodes.java:  New class, extends Procedure2.
	* Makefile.am:  Update accordingly.

	* UnionNodes.java:  It implements Inlineable.

2003-10-08  Per Bothner  <per@bothner.com>

	* Nodes.java (get):  Fix off-by-one bug.

2003-09-24  Per Bothner  <per@bothner.com>

	* NodeConstructor.java:  New abstract class, extends CpsProcedure.
	* Makefile.am:  Update accordingly.
	* AttributeConstructor.java:  Now extends NodeConstructor.
	(apply):  Update.  (compileToNode):  New, replaces compile method.
	* DocumentConstructor.java:  Likewise.
	* ElementConstructor.java:  Likewise.  Move getReturnType up.
	* TextConstructor.java:  Use two NodeConstructor helper methods.

2003-09-18  Per Bothner  <per@bothner.com>

	* Nodes.java (root):  New static methods.

2003-09-14  Per Bothner  <per@bothner.com>

	* AncestorAxis.java:  New class, extends TreeScanner.
	* AncestorOrSelfAxis.java:  Likewise.
	* FollowingAxis.java:  Likewise.
	* FollowingSiblingAxis.java:  Likewise.
	* PrecedingAxis.java:  Likewise.
	* PrecedingSiblingAxis.java:  Likewise.

	* ChildAxis.java (scan):  Re-write to use nextMatching.
	* DescendantAxis.java (scan):  Likewise.
	* DescendantOrSelfAxis.java (scan):  Likewise.

	* NamedAttributes.java:  Removed - no longer used.
	* NamedChildren.java:  Likewise.
	* NamedDescendants.java:  Likewise.
	* Makefile.am:  Update accordingly.

2003-09-09  Per Bothner  <per@bothner.com>

	* CoerceNodes.java:  New class, extends Procedure1.
	* Nodes.java:  New class, extends Values,
	* Makefile.am (java_sources):  Update accordingly.
	* SortNodes.java (apply1, compile):  Canonicalize result.
	* SortedNodes.java:  Now extends Nodes.
	Many methods are now inherited from Nodes.

2003-09-04  Per Bothner  <per@bothner.com>

	* SortNodes.java (compile):  Fix infinite compile-time recursion.

	* Focus.java (size, contextSize):  Remove unused fields.

	* ParentAxis.java (scan):  Fix thinko.

2003-08-03  Per Bothner  <per@bothner.com>

	* SortedNodes.java (finishFragment):  Move writePosition call to
	startFragment, so consuming won't miss any final values.

	* NodeType.java (ATTRIBUTE_OK):  New constant.
	(isInstance(AbstractSequence,int,int)):  Always false if EOF_VALUE.
	Check ATTRIBUTE_OK if ATTRIBUTE_VALUE.
	* SortNodes.java (numArgs):  Remove redundant method.
	(typeSortedNodes, makeSortedNodesMethod):  Make public.

	* TreeScanner.java:  New class, extends CpsProcedure.
	* AttributeAxis.java:  New class, extends TreeScanner.
	* ChildAxis.java:  New class, extends TreeScanner.
	* DescendantAxis.java:  New class, extends TreeScanner.
	* DescendantOrSelfAxis.java:  New class, extends TreeScanner.
	* ParentAxis.java:  New class, extends TreeScanner.
	* SelfAxis.java:  New class, extends TreeScanner.
	* AttributeType.java:  New class, extends NodeType.
	* Makefile.am (java_sources):  Update accordingly.

2003-08-02  Per Bothner  <per@bothner.com>

	* ElementType.java (getImplementationType):  New method.

	* Document.java (parse):  Create a NodeTree, not a TreeList.

2003-08-01  Per Bothner  <per@bothner.com>

	* UnionNodes.java:  New class, extends Procedure2.
	* Makefile.am (java_sources):  Update accordingly.

2003-07-26  Per Bothner  <per@bothner.com>

	* SortedNodes.java:  New class, extends Values.
	* SortNodes.java:  New class, extends Procedure1.
	* Makefile.am (java_sources):  Update accordingly.

	* ElementConstructor.java (compileUsingNodeTree):  Use new
	ConsumerTarget.compileUsingConsumer helper method.

2003-07-23  Per Bothner  <per@bothner.com>

	* NodeCompare.java:  New class, extends Procedure2.
	* Makefile.am (java_sources):  Update accordingly.

2003-07-10  Per Bothner  <per@bothner.com>

	* ElementConstructor.java (compileUsingNodeTree):  New static method.
	(typeNodeTree):  New static field.
	(compile):  Use compileUsingNodeTree.

2003-06-27  Per Bothner  <per@bothner.com>

	* XMLParser.java (<init>):  Re-do to deal with NamespaceResolver
	being merged into ParsedXMLToConsumer.

	* NodeType.java (isObject(Object)):  New method.
	* ElementType.java (isInstancePos):  If kind is OBJECT_VALUE, try
	isInstance(Object).  Fixes bug 6/17 by reported vizawalou@wanadoo.fr.

2003-06-13  Per Bothner  <per@bothner.com>

	* AttributeConstructor.java (apply):  Use CallContext's getNextArg
	method rather than getArgAsObject, which will be deprecated.
	* DocumentConstructor.java (apply):  Likewise.
	* ElementConstructor.java (apply):  Likewise.
	* TextConstructor.java (apply):  Likewise.

2003-05-21  Per Bothner  <per@bothner.com>

	* NamedAttributes.java (namedAttributes):  Use posToDataIndex.
	Fixes bug reported 05-18 by Seshukumar_Adiraju@infosys.com.

2003-05-04  Per Bothner  <per@bothner.com>

	* ListItems.java:  Handle non-Java2 case.
	* IteratorItems.java:  Handle non-Java2 case.

2003-05-03  Per Bothner  <per@bothner.com>

	* Focus.java.in:  Renemed to ..
	* Focus.java:   and changed to use new JAVA1/JAVA2 switching.
	* Makefile.am:  Update accordingly.

2003-05-02  Per Bothner  <per@bothner.com>

	* XMLParser.java (<init>):  New constructors automatically
	allocate a NamespaceResolver.
	* Document.java (parse):  Use new XMLParser constructor.
	Pass 'header' to SyntaxException constructor.

2003-04-30  Per Bothner  <per@bothner.com>

	* DefineNamespace.java (scanForDefinitions):  Set namespace
	Declaration's type to java.lang.String.

2003-04-14  Per Bothner  <per@bothner.com>

	* DefineNamespace.java (scanForDefinitions):  Use Translator's
	push method instead of pushBinding.

2003-03-04  Per Bothner  <per@bothner.com>

	* DocumentConstructor.java:  New class, extends CpsProcedure.
	* TextConstructor.java:  New class, extends CpsProcedure.
	* NodeName.java:  New class, extends Procedure1.
	* Makefile.am (java_sources):  Add new classes.

2003-03-02  Per Bothner  <per@bothner.com>

	* Document.java (makeUrl):  The 'url' argument can be a URL as well as
	a string, and now also takes a 'base' parameter.
	(parse, apply):  Use new new makeURL.
	(apply):  Implement specification in allowing a sequence of URLs,
	and an optional 'base' second parameter.

2003-02-13  Per Bothner  <per@bothner.com>

	* Document.java (parse):  Call writeBaseUri if a TreeList.

2003-01-09  Per Bothner  <per@bothner.com>

	* Attributes.java:  Update for gnu.lists changes.
	* ElementType.java:  Likewise.
	* NamedAttributes.java:  Likewise.
	* NamedDescendants.java:  Likewise.
	* NodeType.java:  Likewise.
	* NamedChildren.java:  Likewise.
	* NamedChildren.java (namedChildren):  Exit if no more children.
	* ListItems.java (apply):  Optimize - try using consumePosRange.

2002-11-23  Per Bothner  <per@bothner.com>

	* IteratorItems.java:  New class, extends CpsProcedure.
	* ListItems.java:  New class, extends CpsProcedure.
	* Makefile.am (java_sources):  Update accordingly.

2002-11-20  Per Bothner  <bothner@bothner.com>

	* NamespaceEnv.java (get):  Handle "class:" namespaces.

2002-11-16  Per Bothner  <per@bothner.com>

	* NamespaceEnv.java (NAMESPACE_PREFIX):  Moved to Interpreter.
	(get):  Update acordingly.
	* DefineNamespace.java (scanForDefinitions):  Likewise.

	* AttributeConstructor.java, ElementConstructor.java, ElementType.java,
	NamedAttributes.java:  Use gnu.mapping.Symbol instead of gnu.xml.QName.

2002-07-28  Per Bothner  <per@bothner.com>

	* NodeType.java:  Also implement TypeValue.
	(toString):  New method.
	(emitCoerceOrNullMethod, emitTestIf, emitIsInstance):  New methods.
	* ElementType.java (emitTestIf, emitIsInstance):  Moved up to NodeType.
	(emitCoerceOrNullMethod):  New protected method, overrides NodeType.

2002-07-21  Per Bothner  <per@bothner.com>

	* MakeUnescapedData.java (inline):  Take extra ExpWalker parameter.

2002-07-02  Per Bothner  <per@bothner.com>

	* HttpPrinter.java (addHeader):  Use Vector's addElement rather
	than add method, which is not in JDK 1.1.

2002-06-26  Per Bothner  <per@bothner.com>

	* XMLParser.java:  Share buffer with LineBufferedReader.
	(fill):  New method, to synchronize and read from LineBufferedReader.
	(error, getName, getLineNumber, getColumnNjmber):  New methods.

2002-06-24  Per Bothner  <per@bothner.com>

	* XMLParser.java:  New class, extends gnu.xml.XMLParserChar.
	* Makefile.am (java_sources);  Add new file.
	* Document.java (document):  Rename static helper methods to 'parse'.
	Inline ParsedXMLToConsumer.parse, which is now gone.
	Allocate new XMLParser instance.

2002-06-10  Per Bothner  <per@bothner.com>

	* NamedDescendants.java:  Support descdendant-or-self.

	* NodeType.java (coerceOrForce):  Better exception message.

2002-05-19  Per Bothner  <per@bothner.com>

	* ElementType.java (coerceOrNull):  Test coerceOrNull result for null.

2002-05-06  Per Bothner  <per@bothner.com>

	* Focus.java.in:  New class, moved from gnu/xquery/util.
	* Makefile.am (Focus.java):  New rule.

	* NamedChildren.java (namedChildren):  Use TreePosition push/pop.

2002-04-07  Per Bothner  <per@bothner.com>

	* NamedAttributes.java:  Take single QName argument.

	* ElementType.java (coerceOrNull):  Use NodeType's coerceOrNull.
	* NamedDescendants.java:  Accept general NodePredicate rather than
	just a GroupRedpcate.  Should rename class!
	* NamedChildren.java:  Likewise.
	(namedChildren):  Use nextNodeIndex.

	* NodeType.java:  Implement NodePredicate and Externalizable.
	(writeExternal, readExternal):  New methods.
	(TEXT_OK, GROUP_OK):  New constants.
	(kinds):  New field.
	(<init>):  Set kinds field.
	(emitCoerceFromObject):  Also push value of kinds.
	(coerceFromObject):  Cal ceorceForce instead of coerce.
	(isInstance):  New methods.
	(coerceOrNull, ceorceForce):  New methods.
	(coerce):  Remove method.

2002-03-07  Per Bothner  <per@bothner.com>

	* ElementType.java:  New constructor.
	(getNamespaceURI, getLocalName):  New accessor methods.
	(isInstance):  Check that argument triple is actually a group.
	(coerceOrNull):  Likewise.

	* NamedDescendants.java (apply, namedDescendants):  Take a single
	GroupPredicate argument instead of a namespaceURL+localName pair.
	* NamedChildren.java (namedChildren, apply, getNamedChild):  Likewise.
	(getNamedChild):  Use predicate's isInstance method.
	(numArgs):  Takes 2 instead of 3 arguments.
	(compile):  Update accordingly.  Update for new SeriesTarget semantics.
	Can now safely pushScope/popScope.

2002-03-02  Per Bothner  <per@bothner.com>

	* HttpPrinter.java (beginData):  Write out and clear sbuf buffer.
	(writeObject):  If value is Consumable but not UnescapedData (e.g. a
	TreeList containing response-header attributes), consume it.
	(write):  New method.

2002-02-14  Per Bothner  <per@bothner.com>

	* HttpPrinter.java (sawContentType):  Make protected, for used
	by ServletPrinter.

2002-02-13  Per Bothner  <per@bothner.com>

	* ElementConstructor.java (apply): Check if body object is Consumable.

2002-02-05  Per Bothner  <per@bothner.com>

	* NamedChildren.java:  Moved from gnu.xquery.util.
	* NodeType.java  Moved from gnu.xquery.util.
	* ElementType.java  Moved from gnu.xquery.util.
	* NamedDescendants.java:  New class, extends CpsProcedure.
	* Makefile.am:  Update accordingly.

	* NamedChildren.java:  Implement Externalizable.
	(writeExternal, readExternal):  New methods.

	* NamedChildren.java:  Implement GroupPredicate.
	(isInstance):  New methods, needed for GroupPredicate.
	(<init>):  New constructor.

	* package.html:  New file, for javadoc.

2002-01-29  Per Bothner  <per@bothner.com>

	* WriteTo.java (writeTo):  Disambiguate XMLPrinter constructor.

2002-01-23  Per Bothner  <per@bothner.com>

	* HttpPrinter.java (beginData):  New method.
	(beginGroup):  Call beginData.
	(writeObject):  New method, calls beginData.

2002-01-21  Per Bothner  <per@bothner.com>

	* Document.java:  Moved form gnu.xquery.util.
	(document):  Use ParsedXMLToConsumer.parse.  Remove 1 overload.
	* MakeUnescapedData.java: New class, extends Procedure1.
	* Makefile.am:  Update accordingly.

	* Document.java:  Moved from gnu.xquery.util.

2002-01-19  Per Bothner  <per@bothner.com>

	* Write.java:  Moved from gnu.kawa.functions.
	* Makefile.am:  Update accordingly.

2002-01-13  Per Bothner  <per@bothner.com>

	* HttpPrinter.java:  New class, extends FilterConsumer,
	* MakeResponseHeader.java:  new class, extends CpsProcedure.
	* Makefile.am (java_sources):  Update accordingly.

2001-11-24  Jim White <jim@pagesmiths.com>

	* Attributes.java:  Fix/update 'package' declaration.

2001-11-24  Per Bothner  <per@bothner.com>

	* ElementConstructor.java (compile):  Use compileWithPosition.

	* NamespaceEnv.java (get):  Recognize ':name' as no namespace.

2001-11-18  Per Bothner  <per@bothner.com>

	* DefineNamespace.java:  New class, moved and renamed from
	kawa.standard.define_namespace.

2001-11-12  Per Bothner  <per@bothner.com>

	* ElementConstructor.java (compile):  Fix off-by-one error.

	* ElementConstructor.java (getmlName,getQName, getnNmespaceURI,
	getLocalName, getPrefix, toString):  New helper methods.
	* AttributeConstructor.java:  New class, extends CpsProcedure.
	* Makefile.am (java_sources):  Add AttributeConstructor.java.

	* NamespaceEnv.java (NAMESPACE_PREFIX):  New constant.
	(get):  Use NAMESPACE_PREFIX.

2001-11-06  Per Bothner  <per@bothner.com>

	* OutputAsXML.java:  New class, extends CpsProcedure.

2001-11-01  Per Bothner  <per@bothner.com>

	* NamedAttributes.java:  Fixed wrong "package" specifier.  Oops.

2001-10-19  Per Bothner  <per@bothner.com>

	* NamespaceEnv.java:  New class extends Environment.
	* Makefile.am:  Update accordingly.

2001-10-17  Per Bothner  <per@bothner.com>

	New package.  XML-related Procedures and other classes.
	* Attributes.java:  New class, extends CpsProcedure.
	* ElementConstructor.java:  New class, extends CpsProcedure.
	* NamedAttributes.java:  New class, extends CpsProcedure.
	* Makefile.am: New file.
